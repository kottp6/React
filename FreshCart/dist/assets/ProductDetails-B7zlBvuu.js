import{r as a,i as j,j as e,L as N,b as y,C as v,B as f}from"./index-D1iCoGWQ.js";import{P as w}from"./Product-DFBqJOme.js";function P(){const[s,n]=a.useState(null),[l,c]=a.useState(!1),[m,o]=a.useState([]),{category:i}=j();async function x(){c(!0);try{const{data:t}=await y.get("https://ecommerce.routemisr.com/api/v1/products"),d=t.data.filter(g=>g.category.name===i);o(d),console.log(d),n(null)}catch(t){console.log(t),n(t.response.data.message),o([])}finally{c(!1)}}return a.useEffect(()=>{x()},[]),e.jsx("section",{className:"py-20",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsx("h1",{className:"text-lg",children:"Related Product"}),l?e.jsx(N,{}):s?e.jsx("div",{className:"alert alert-error",children:s}):e.jsx("div",{className:"row",children:m.map(t=>e.jsx(w,{product:t},t.id))})]})})}function C(){var u;const[s,n]=a.useState({}),[l,c]=a.useState(null),[m,o]=a.useState(!1),{id:i}=j(),{addToCart:x}=a.useContext(v),t=a.useRef(0);async function d(h){const r=await x(h);r.status==="success"?f.success(r.message,{theme:"dark"}):f.error("Something went wrong",{theme:"dark"})}async function g(h){o(!0);try{const{data:r}=await y.get(`https://ecommerce.routemisr.com/api/v1/products/${h}`);console.log(r.data),n(r.data),c(null)}catch(r){console.log(r),c(r.response.data.message),n([])}finally{o(!1)}}return a.useEffect(()=>{g(i),console.log(t)},[i]),e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"py-20",children:e.jsx("div",{className:"container mx-auto",children:m?e.jsx(N,{}):l?e.jsx("div",{className:"alert alert-error",children:l}):e.jsxs("div",{className:"row",ref:toTop,children:[e.jsx("div",{className:"w-1/3 px-4",children:e.jsx("img",{src:s==null?void 0:s.imageCover,alt:s==null?void 0:s.title})}),e.jsxs("div",{className:"w-2/3 px-4",children:[e.jsx("h1",{className:"text-2xl mb-2",children:s==null?void 0:s.title}),e.jsx("p",{className:"mb-2 text-gray-500 font-light",children:s==null?void 0:s.description}),e.jsxs("div",{className:"flex justify-between text-gray-500 font-light",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"mb-2",children:(u=s==null?void 0:s.category)==null?void 0:u.name}),e.jsx("span",{children:s==null?void 0:s.price})]}),e.jsxs("div",{children:[e.jsx("i",{className:"fas fa-star text-yellow-300"}),e.jsx("span",{children:s==null?void 0:s.ratingsAverage})]})]}),e.jsx("button",{onClick:()=>d(s==null?void 0:s.id),className:"btn btn-green w-full",children:"Add To Cart"})]})]})})}),e.jsx(P,{})]})}export{C as default};
